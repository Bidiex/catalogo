<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Catálogo - TraeGo</title>
  <link rel="icon" type="image/svg+xml" href="/src/assets/icon_traego.svg" id="dynamicFavicon" />
  <link rel="stylesheet" href="/src/styles/global.css">
  <link rel="stylesheet" href="/src/pages/catalog/catalog.css">
</head>

<body>
  <!-- Loading Modal -->
  <div id="loadingState" class="loading-modal">
    <div class="loading-modal-content">
      <div class="loading-spinner-container">
        <div class="loading-logo" id="loadingLogo">
          <i class="ri-restaurant-line"></i>
        </div>
        <div class="loading-spinner-ring"></div>
      </div>
      <h2>Cargando catálogo</h2>
      <p>Por favor espera un momento...</p>

      <div class="loading-brand-container">
        <p class="loading-brand-text">Tecnología</p>
        <div class="loading-brand-logos">
          <img src="/src/assets/icon_traego.svg" alt="Icono" class="loading-brand-icon">
          <img src="/src/assets/logo_traego.svg" alt="TraeGo" class="loading-brand-logo">
        </div>
      </div>
    </div>
  </div>

  <!-- Error state -->
  <div id="errorState" class="error-state unified-error-container" style="display: none;">
    <div class="content">
      <img src="/src/assets/avatar-404.webp" alt="Error" class="unified-error-avatar" />
      <h2 class="unified-error-title">Catálogo no encontrado</h2>
      <p class="unified-error-description">El catálogo que buscas no existe o no está disponible.</p>

      <div class="unified-error-actions">
        <button id="catalog-go-back-btn" class="unified-error-btn unified-error-btn-secondary"
          onclick="window.history.back()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 12H5" />
            <path d="M12 19l-7-7 7-7" />
          </svg>
          Volver atrás
        </button>
        <a href="/" class="unified-error-btn unified-error-btn-primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
            <polyline points="9 22 9 12 15 12 15 22" />
          </svg>
          Ir al inicio
        </a>
      </div>
    </div>
  </div>

  <!-- Maintenance/Inactive state -->
  <div id="maintenanceState" class="maintenance-state" style="display: none;">
    <div class="maintenance-content">
      <div class="maintenance-icon">
        <i class="ri-store-3-line"></i>
        <div class="status-badge">
          <i class="ri-pause-circle-fill"></i>
        </div>
      </div>
      <h2>Negocio no disponible</h2>
      <p>Este catálogo se encuentra temporalmente en pausa. Por favor intenta contactar directamente al propietario.</p>

      <div class="maintenance-actions">
        <button id="maintenanceWhatsAppBtn" class="btn-primary" style="display: none;">
          <i class="ri-whatsapp-line"></i> Contactar por WhatsApp
        </button>
      </div>
    </div>
  </div>

  <!-- Main catalog -->
  <div id="catalogContent" style="display: none;">

    <!-- ===== DESKTOP SIDEBAR (Left) ===== -->
    <aside id="desktopSidebar" class="desktop-sidebar">
      <!-- Content injected by JS -->
      <div class="sidebar-brand">
        <div id="sidebarLogo" class="sidebar-logo"></div>
        <h2 id="sidebarBusinessName"></h2>
      </div>

      <div class="sidebar-info">
        <p id="sidebarDescription"></p>
        <div class="sidebar-contact">
          <div id="sidebarAddress" class="contact-item" style="display: none;">
            <i class="ri-map-pin-line"></i> <span class="text"></span>
          </div>
          <div id="sidebarPhone" class="contact-item" style="display: none;">
            <i class="ri-whatsapp-line"></i> <span class="text"></span>
          </div>
        </div>
      </div>

      <!-- Categories in Sidebar -->
      <div id="sidebarCategories" class="sidebar-categories">
        <!-- Injected by JS -->
      </div>
    </aside>

    <!-- ===== CENTER CONTENT WRAPPER ===== -->
    <div class="catalog-center-content">
      <!-- ===== STICKY WRAPPER ===== -->
      <div class="catalog-sticky-wrapper" id="stickyWrapper">
        <!-- Header -->
        <header class="catalog-header" id="catalogHeader">
          <div class="header-content">
            <!-- Row 1: Logo + Name -->
            <div class="header-top-row">
              <div class="business-logo" id="headerLogo"
                style="display: none; width: 60px; height: 60px; border-radius: 50%; overflow: hidden; flex-shrink: 0; background-color: white;">
              </div>
              <h1 id="businessName">Cargando...</h1>
              <div style="display: flex; gap: 0.5rem;">
                <button id="headerTrackOrderBtn" class="header-share-btn" aria-label="Seguir mis pedidos"
                  style="display: none;" title="Seguir mis pedidos">
                  <i class="ri-motorbike-line"></i>
                </button>
                <button id="headerShareBtn" class="header-share-btn" aria-label="Compartir catálogo">
                  <i class="ri-share-forward-line"></i>
                </button>
              </div>
            </div>

            <div class="header-bottom-row">
              <p id="businessDescription"></p>
              <div class="business-contact-info">
                <div id="businessAddress" class="contact-item" style="display: none;">
                  <i class="ri-map-pin-line"></i>
                  <span class="text"></span>
                </div>
                <div id="businessPhone" class="contact-item" style="display: none;">
                  <i class="ri-whatsapp-line"></i>
                  <span class="text"></span>
                </div>
              </div>
            </div>
          </div>
        </header>

        <div class="desktop-search-nav-row">
          <!-- Search Bar -->
          <div class="catalog-search-container">
            <div class="catalog-search-bar">
              <i class="ri-search-line"></i>
              <input type="text" id="catalogSearchInput" placeholder="Buscar productos..." />
              <button id="clearCatalogSearch" class="catalog-search-clear" style="display: none;">
                <i class="ri-close-line"></i>
              </button>
            </div>
          </div>

          <!-- Categories navigation -->
          <div class="categories-nav-wrapper">
            <button id="scrollLeft" class="nav-arrow left" aria-label="Anterior">
              <i class="ri-arrow-left-s-line"></i>
            </button>
            <nav class="categories-nav" id="categoriesNav">
              <div class="categories-nav-track">
                <button class="category-nav-btn active" data-category="all">Todos</button>
              </div>
            </nav>
            <button id="scrollRight" class="nav-arrow right" aria-label="Siguiente">
              <i class="ri-arrow-right-s-line"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Promo Banner / Carousel (Moved below sticky wrapper) -->
      <div class="promo-banner-container" id="promoBannerContainer" style="display: none;">
        <div class="promo-carousel" id="promoCarousel">
          <div class="promo-slides-container" id="promoSlides">
            <!-- Slides injected by JS -->
            <div class="promo-slide active">
              <div class="promo-placeholder">
                <i class="ri-fire-line"></i>
                <span>Cargando promociones...</span>
              </div>
            </div>
          </div>
          <div class="carousel-indicators" id="carouselIndicators"></div>

          <!-- Optional Controls if needed, but we rely on autoplay/indicators -->
        </div>
      </div>

      <!-- Products by category -->
      <main class="catalog-main">
        <div id="productsContainer" class="products-container">
          <!-- Se llenarán dinámicamente -->
        </div>
      </main>
    </div> <!-- End .catalog-center-content -->

    <!-- Cart floating button -->
    <div class="cart-fab" id="cartFab" style="display: none;">
      <button class="cart-fab-btn" id="cartFabBtn">
        <i class="ri-shopping-cart-line cart-icon"></i>
        <span class="cart-count" id="cartCount">0</span>
      </button>
    </div>

    <!-- Cart panel -->
    <div class="cart-panel" id="cartPanel">
      <div class="cart-overlay" id="cartOverlay"></div>
      <div class="cart-content">
        <div class="cart-header">
          <h2><i class="ri-shopping-bag-line"></i> Tu pedido</h2>
          <button class="cart-close" id="cartClose">
            <i class="ri-close-line"></i>
          </button>
        </div>

        <div class="cart-body" id="cartBody">
          <p class="empty-cart-message">El carrito está vacío</p>
        </div>

        <div class="cart-suggestions" id="cartSuggestions"
          style="display: none; padding: 1rem 1.5rem; background: #f8fafc; border-top: 1px solid var(--color-border); border-bottom: 1px solid var(--color-border);">
          <h3 style="font-size: 0.95rem; margin-bottom: 0.75rem; color: var(--color-text); font-weight: 600;">
            <i class="ri-magic-line" style="color: var(--color-primary); margin-right: 4px;"></i> Te sugerimos sumar:
          </h3>
          <div class="suggestions-scroller" id="cartSuggestionsScroller"
            style="display: flex; gap: 0.75rem; overflow-x: auto; padding-bottom: 0.5rem; scroll-snap-type: x mandatory;">
            <!-- Vía JS -->
          </div>
        </div>

        <div class="cart-footer" id="cartFooter" style="display: none;">
          <div class="cart-total">
            <span>Total:</span>
            <span class="cart-total-amount" id="cartTotalAmount">$0</span>
          </div>
          <button class="btn-whatsapp" id="btnWhatsapp">
            <i class="ri-whatsapp-fill"></i>
            <span>Pedir por WhatsApp</span>
          </button>
        </div>
      </div>
    </div>

  </div>

  <!-- Product detail modal -->
  <div class="product-modal" id="productModal" style="display: none;">
    <div class="product-modal-overlay" id="productModalOverlay"></div>
    <div class="product-modal-content">

      <!-- Modal Header (Fixed) -->
      <div class="product-modal-header">
        <span class="product-modal-header-title" id="productModalHeaderTitle"></span>
        <div class="product-modal-header-actions">
          <button class="product-modal-action-btn" id="productShareBtn">
            <i class="ri-share-line"></i>
          </button>
          <button class="product-modal-action-btn" id="productModalClose">
            <i class="ri-close-line"></i>
          </button>
        </div>
      </div>

      <!-- Modal Body (Scrollable) -->
      <div class="product-modal-body">
        <div class="product-modal-image" id="productModalImage">
          <img src="" alt="">
        </div>

        <div class="product-modal-info">
          <h2 id="productModalName">Producto</h2>
          <p class="product-modal-price" id="productModalPrice">$0</p>
          <p class="product-modal-description" id="productModalDescription"></p>

          <!-- Quick Comments -->
          <div class="product-options-section hidden" id="quickCommentsSection">
            <h3>Comentarios rápidos</h3>
            <div class="quick-comments-list" id="quickCommentsList"></div>
          </div>

          <!-- Sides -->
          <div class="product-options-section hidden" id="sidesSection">
            <h3>Acompañantes</h3>
            <div class="sides-list" id="sidesList"></div>
          </div>
        </div>
      </div>

      <!-- Modal Footer (Fixed) -->
      <div class="product-modal-footer">
        <div class="product-modal-quantity">
          <button class="quantity-btn" id="decreaseQty">
            <i class="ri-subtract-line"></i>
          </button>
          <span class="quantity-value" id="quantityValue">1</span>
          <button class="quantity-btn" id="increaseQty">
            <i class="ri-add-line"></i>
          </button>
        </div>
        <button class="btn-add-to-cart" id="addToCartBtn">
          <i class="ri-shopping-cart-line"></i>
          Agregar al carrito
        </button>
      </div>

    </div>
  </div>


  <!-- Promotion detail modal -->
  <div class="product-modal" id="promotionModal" style="display: none;">
    <div class="product-modal-overlay" id="promotionModalOverlay"></div>
    <div class="product-modal-content">

      <!-- Modal Header (Fixed) -->
      <div class="product-modal-header">
        <span class="product-modal-header-title" id="promotionModalHeaderTitle"></span>
        <div class="product-modal-header-actions">
          <button class="product-modal-action-btn" id="promotionShareBtn">
            <i class="ri-share-line"></i>
          </button>
          <button class="product-modal-action-btn" id="promotionModalClose">
            <i class="ri-close-line"></i>
          </button>
        </div>
      </div>

      <!-- Modal Body (Scrollable) -->
      <div class="product-modal-body">
        <div class="product-modal-image" id="promotionModalImage">
          <img src="" alt="">
        </div>

        <div class="product-modal-info">
          <h2 id="promotionModalTitle">Promoción</h2>
          <p class="product-modal-price" id="promotionModalPrice">$0</p>
          <p class="product-modal-description" id="promotionModalDescription"></p>

          <!-- Quick Comments -->
          <div class="product-options-section hidden" id="promotionQuickCommentsSection">
            <h3>Comentarios rápidos</h3>
            <div class="quick-comments-list" id="promotionQuickCommentsList"></div>
          </div>

          <!-- Sides -->
          <div class="product-options-section hidden" id="promotionSidesSection">
            <h3>Acompañantes</h3>
            <div class="sides-list" id="promotionSidesList"></div>
          </div>
        </div>
      </div>

      <!-- Modal Footer (Fixed) -->
      <div class="product-modal-footer">
        <div class="product-modal-quantity">
          <button class="quantity-btn" id="promotionDecreaseQty">
            <i class="ri-subtract-line"></i>
          </button>
          <span class="quantity-value" id="promotionQuantityValue">1</span>
          <button class="quantity-btn" id="promotionIncreaseQty">
            <i class="ri-add-line"></i>
          </button>
        </div>
        <button class="btn-add-to-cart" id="addPromotionToCartBtn">
          <i class="ri-shopping-cart-line"></i>
          Agregar al carrito
        </button>
      </div>

    </div>
  </div>


  <!-- Checkout Modal -->
  <div class="checkout-modal" id="checkoutModal" style="display: none;">
    <div class="checkout-modal-overlay" id="checkoutModalOverlay"></div>
    <div class="checkout-modal-content">
      <div class="checkout-modal-header">
        <h2><i class="ri-user-line"></i> Completa tus datos</h2>
        <button class="checkout-modal-close" id="checkoutModalClose">
          <i class="ri-close-line"></i>
        </button>
      </div>

      <form class="checkout-form" id="checkoutForm">
        <div class="form-group">
          <label for="clientName">
            <i class="ri-user-line"></i> Nombre completo *
          </label>
          <input type="text" id="clientName" name="clientName" placeholder="Ej: Juan Pérez" required>
        </div>

        <div class="form-group">
          <label for="clientPhone">
            <i class="ri-phone-line"></i> Teléfono *
          </label>
          <input type="tel" id="clientPhone" name="clientPhone" placeholder="Ej: 3001234567" required>
        </div>

        <div class="form-group">
          <label for="clientAddress">
            <i class="ri-map-pin-line"></i> Dirección de entrega *
          </label>
          <textarea id="clientAddress" name="clientAddress" rows="2" placeholder="Ej: Calle 123 #45-67, Apto 301"
            required></textarea>
        </div>

        <div class="form-group">
          <label for="clientBarrio">
            <i class="ri-map-pin-2-line"></i> Barrio *
          </label>
          <input type="text" id="clientBarrio" name="clientBarrio" placeholder="Ej: Recreo, Barranquilla" required>
        </div>

        <div class="form-group">
          <label for="paymentMethod">
            <i class="ri-bank-card-line"></i> Método de pago *
          </label>
          <select id="paymentMethod" name="paymentMethod" required>
            <option value="">Selecciona un método</option>
            <option value="Efectivo">Efectivo</option>
            <option value="Transferencia">Transferencia</option>
            <option value="Tarjeta">Tarjeta</option>
            <option value="Nequi">Nequi</option>
            <option value="Daviplata">Daviplata</option>
          </select>
        </div>

        <div class="form-group">
          <label for="clientNotes">
            <i class="ri-message-3-line"></i> Observaciones (opcional)
          </label>
          <textarea id="clientNotes" name="clientNotes" rows="2" placeholder="Ej: Tocar el timbre 2 veces"></textarea>
        </div>

        <div class="checkout-actions">
          <button type="button" class="btn-cancel" id="cancelCheckoutBtn">
            Cancelar
          </button>
          <button type="submit" class="btn-confirm">
            <i class="ri-whatsapp-fill"></i>
            Enviar pedido
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Order Tracking Modal -->
  <div class="checkout-modal" id="trackingModal" style="display: none;">
    <div class="checkout-modal-overlay" id="trackingModalOverlay"></div>
    <div class="checkout-modal-content" style="max-height: 90vh; display: flex; flex-direction: column;">
      <div class="checkout-modal-header" style="flex-shrink: 0;">
        <h2><i class="ri-motorbike-line"></i> Mis Pedidos</h2>
        <button class="checkout-modal-close" id="trackingModalClose">
          <i class="ri-close-line"></i>
        </button>
      </div>

      <div class="tracking-body" id="trackingBody" style="padding: 1.5rem; overflow-y: auto; flex: 1;">
        <div class="empty-state" style="text-align: center; padding: 2rem 0; color: var(--text-muted);">
          <i class="ri-shopping-bag-3-line"
            style="font-size: 3rem; opacity: 0.5; margin-bottom: 1rem; display: block;"></i>
          <p>No tienes pedidos recientes.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="catalog-footer">
    <div class="footer-content">
      <div class="footer-brand">
        <img src="/src/assets/icon_traego.svg" alt="Traego"
          style="width: 40px; height: 40px; object-fit: contain; margin-right: 0.5rem;" class="footer-icon">
        <span class="footer-brand-name">TraeGo</span>
      </div>

      <div class="footer-link">
        <a href="/" class="btn-footer-link">
          <i class="ri-external-link-line"></i>
          Ir a TraeGo
        </a>
      </div>

      <div class="footer-copyright">
        <p>© 2026 TraeGo. Todos los derechos reservados.</p>
      </div>

    </div>
  </footer>

  <script type="module" src="/src/pages/catalog/catalog.js"></script>
</body>

</html>